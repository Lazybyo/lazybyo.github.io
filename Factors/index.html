<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <title>Game</title>
</head>

<body>
  <audio id="audio" src="music2.mp3"></audio>
  <audio id="click" src="click.mp3"></audio>
  <audio id="heal" src="pop.mp3"></audio>
  <audio id="hurt" src="tap.wav"></audio>
  <audio id="death" src="death.wav"></audio>
  <audio id="dash" src="dash.mp3"></audio>
  <audio id="longPop" src="longPop.wav"></audio>
  <audio id="longPop2" src="longPop.wav"></audio>
  <audio id="mainMenu" src="MainMenu.mp3"></audio>
  <center>
    <canvas id="myCanvas" width="700" height="600"></canvas>
  </center>
    <script>
if (localStorage.getItem("score") == null){
  localStorage.setItem("score", 0);
}
var c = document.getElementById("myCanvas");
var draw = c.getContext("2d");
var leftArrow = false
var rightArrow = false
var upArrow = false
var downArrow = false
var gameLoop
var pos = [100, 100]
var bullets = []
var dooftime = 0
var doofcooldown = 200
var doofset = 1
var hp = 3
var dodgeSpeed = 10
var dodgeDirection = [0, 0]
var dodgeTime = 0
var isDodging = false
var canDodge = true
var space = false
var inmainMenu = true
var aniState = 1
var aniTime = 0
var score = 0
var highScore = 0
var easyHighScore = 0
var mediumHighScore = 0
var theNumber = 5
var mode = "Easy"
var streak = 0
var streakView = 0
var inTutorial = false
var stopped = false
var frame = 0
var pickedUp = false
var frames2 = 0
var phase = 1
var rotation = 0.01
var betweenTime = 0
var time = 0
var hitTime = 0
var nextNumber = 2
var dead = false
var won = false
var info = false
var settings = false
var dashframe = []
var paused = false
var seconds = 0
var minutes = 0
var audio = document.querySelector('audio')
var click = document.querySelector('#click')
var heal = document.querySelector('#heal')
var hurt = document.querySelector('#hurt')
var death = document.querySelector('#death')
var dash = document.querySelector('#dash')
var longPop = document.querySelector('#longPop')
var longPop2 = document.querySelector('#longPop2')
var mainMenuMusic = document.querySelector('#mainMenu')
var musicVolume = 0.6
var sfxVolume = 1
audio.volume = musicVolume
mainMenuMusic.volume = musicVolume
click.volume = sfxVolume
heal.volume = sfxVolume
hurt.volume = sfxVolume
longPop.volume = sfxVolume
longPop2.volume = sfxVolume
death.volume = sfxVolume/2
dash.volume = sfxVolume/2
//draw.globalAlpha = 0.2

audio.addEventListener('ended', function() {
    if (!inmainMenu){
      this.currentTime = 0;
      this.play();
    }
}, false);

mainMenuMusic.addEventListener('ended', function() {
    if (inmainMenu){
      this.currentTime = 0;
      this.play();
    }
}, false);

function getMousePosition(canvas, event) {
    let rect = canvas.getBoundingClientRect();
    let x = event.clientX - rect.left;
    let y = event.clientY - rect.top;
    if (inmainMenu){
      mainMenuMusic.play()
    }
    if (inmainMenu && x >= 630 && x <= 680 && y >= 530 && y <= 580 && !settings){
      click.currentTime = 0
      click.play()
      info = true
      drawRectangle(100, 100, 500, 400, "#17afd1", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Info",300,150);
      draw.font = "20px Arial";
      draw.fillText("This Game is about learning factors. You have to",110,200);
      draw.fillText("collect factors of your number to increase your score",110,230);
      draw.fillText("Hard Mode: Base game to test your knowledge",110,280);
      draw.fillText("Easy Mode: Factor's are highlighted green and",110,330);
      draw.fillText("nonfactors are highlighted red",110,360);
      draw.fillText("Medium Mode: The numbers flash green or red",110,410);
      draw.fillText("Streak: collect factors without taking damage to ",110,460);
      draw.fillText("gain more score when collecting factors",110,490);
      drawRectangle(540, 110, 50, 50, "red", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("X",548,153);
    }else if (x >= 540 && x <= 590 && y >= 110 && y <= 160 && info || x >= 540 && x <= 590 && y >= 110 && y <= 160 && settings){
      click.currentTime = 0
      click.play()
      if (inmainMenu){
        mainMenu()
      }else{
        drawRectangle(100, 70, 500, 430, "grey", 10)
        draw.fillStyle = "black"
        draw.font = "50px Arial";
        draw.fillText("Paused",280,120);
        drawRectangle(200, 380, 300, 100, "#17afd1", 10)
        draw.fillStyle = "black"
        draw.font = "50px Arial";
        draw.fillText("Continue",260,450);
        drawRectangle(200, 260, 300, 100, "#17afd1", 10)
        draw.fillStyle = "black"
        draw.font = "50px Arial";
        draw.fillText("Settings",260,330);
        drawRectangle(200, 140, 300, 100, "#17afd1", 10)
        draw.fillStyle = "black"
        draw.font = "50px Arial";
        draw.fillText("Exit",310,210); 
        settings = false
      }
    }else if (x >= 200 && x <= 500 && y >= 380 && y <= 480 && paused && !settings){
      click.currentTime = 0
      click.play()
      paused = false
      startTimer()
    }
    else if (x >= 200 && x <= 500 && y >= 140 && y <= 240 && paused && !settings){
      click.currentTime = 0
      click.play()
      if (mode == "Hard"){
        if (score > highScore){
          localStorage.setItem("score", score)
        }
      }else if (mode == "Easy" && !inTutorial){
        if (score > easyHighScore){
          localStorage.setItem("easyScore", score)
        }
      }else if (mode == "Medium"){
        if (score > mediumHighScore){
          localStorage.setItem("mediumScore", score)
        }
      }
      inmainMenu = true
      mainMenu()
    }
    else if (inmainMenu && x >= 630 && x <= 680 && y >= 460 && y <= 510 && !info && !settings || x >= 200 && x <= 500 && y >= 260 && y <= 360 && paused && !settings){
      click.currentTime = 0
      click.play()
      settings = true
      drawRectangle(100, 100, 500, 400, "#17afd1", 10)
      drawRectangle(540, 110, 50, 50, "red", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("X",548,153);
      draw.fillText("Settings",260,150);
      draw.font = "40px Arial";
      draw.fillText("Music: ",110,220);
      draw.fillText("Sound Effects: ",110,320);
      drawRectangle(400, 180, 50, 50, "#17afd1", 10)
      drawRectangle(400, 280, 50, 50, "#17afd1", 10)
      if (musicVolume > 0){
        drawLine(410, 205, 425, 220, 10)
        drawLine(425, 220, 440, 185, 10)
        drawLine(420, 220, 430, 220, 7)
      }
      if (sfxVolume > 0){
        drawLine(410, 305, 425, 320, 10)
        drawLine(425, 320, 440, 285, 10)
        drawLine(420, 320, 430, 320, 7)
      }
    }
    else if (settings && x >= 400 && x <= 450 && y >= 180 && y <= 230 && !info){
      click.currentTime = 0
      click.play()
      if (musicVolume > 0){
        musicVolume = 0
      }else{
        musicVolume = 0.6
      }
      drawRectangle(100, 100, 500, 400, "#17afd1", 10)
      drawRectangle(540, 110, 50, 50, "red", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("X",548,153);
      draw.fillText("Settings",260,150);
      draw.font = "40px Arial";
      draw.fillText("Music: ",110,220);
      draw.fillText("Sound Effects: ",110,320);
      drawRectangle(400, 180, 50, 50, "#17afd1", 10)
      drawRectangle(400, 280, 50, 50, "#17afd1", 10)
      if (musicVolume > 0){
        drawLine(410, 205, 425, 220, 10)
        drawLine(425, 220, 440, 185, 10)
        drawLine(420, 220, 430, 220, 7)
      }
      if (sfxVolume > 0){
        drawLine(410, 305, 425, 320, 10)
        drawLine(425, 320, 440, 285, 10)
        drawLine(420, 320, 430, 320, 7)
      }
    }else if (settings && x >= 400 && x <= 450 && y >= 280 && y <= 330 && !info){
      click.currentTime = 0
      click.play()
      if (sfxVolume > 0){
        sfxVolume = 0
      }else{
        sfxVolume = 1
      }
      drawRectangle(100, 100, 500, 400, "#17afd1", 10)
      drawRectangle(540, 110, 50, 50, "red", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("X",548,153);
      draw.fillText("Settings",260,150);
      draw.font = "40px Arial";
      draw.fillText("Music: ",110,220);
      draw.fillText("Sound Effects: ",110,320);
      drawRectangle(400, 180, 50, 50, "#17afd1", 10)
      drawRectangle(400, 280, 50, 50, "#17afd1", 10)
      if (musicVolume > 0){
        drawLine(410, 205, 425, 220, 10)
        drawLine(425, 220, 440, 185, 10)
        drawLine(420, 220, 430, 220, 7)
      }
      if (sfxVolume > 0){
        drawLine(410, 305, 425, 320, 10)
        drawLine(425, 320, 440, 285, 10)
        drawLine(420, 320, 430, 320, 7)
      }
    }
    else if (x >= 200 && x <= 500 && y >= 100 && y <= 200 && inmainMenu && !info && !settings){
      click.currentTime = 0
      click.play()
      inmainMenu = false
      mainMenuMusic.pause()
      audio.play()
      startTimer()
    }
    else if (x >= 200 && x <= 500 && y >= 250 && y <= 350 && inmainMenu  && !info && !settings){
      click.currentTime = 0
      click.play()
      if (mode == "Easy"){
        mode = "Medium"
      }else if (mode == "Medium"){
        mode = "Hard"
      }else if (mode == "Hard"){
        mode = "Easy"
      }
      mainMenu()
    }
    else if (x >= 200 && x <= 500 && y >= 400 && y <= 500 && inmainMenu && !info && !settings){
      click.currentTime = 0
      click.play()
      inTutorial = true
      mode = "Easy"
      inmainMenu = false
      pickedUp = false
      hp = 1
      theNumber = 5
      nextNumber = 6
      frames2 = 0
      frame = 0
      stopped = false
      mainMenuMusic.pause()
      audio.play()
      startTimer()
    }
    else if (canDodge && !inmainMenu && !dead){
      dodge(x, y, "click")
    }else if (dead && x > 230 && x < 470 && y > 300 && y < 400 ||won && x > 230 && x < 470 && y > 300 && y < 400 ){
      inmainMenu = true
      mainMenu()
      click.currentTime = 0
      click.play()
    }
    audio.volume = musicVolume
    click.volume = sfxVolume
    heal.volume = sfxVolume
    hurt.volume = sfxVolume
    longPop.volume = sfxVolume
    longPop2.volume = sfxVolume
    death.volume = sfxVolume/2
    dash.volume = sfxVolume/2
}

c.addEventListener("mousedown", function (e) {
    getMousePosition(c, e);
}); 

document.addEventListener('keydown', function(event) {
  if (event.keyCode == 37 || event.keyCode == 65) {
    leftArrow = true
  }
  if (event.keyCode == 39 || event.keyCode == 68) {
    rightArrow = true
  }
  if (event.keyCode == 38 || event.keyCode == 87) {
    upArrow = true
  }
  if (event.keyCode == 40 || event.keyCode == 83) {
    downArrow = true
  }
  if (event.keyCode == 32) {
    space = true
  }
  if (event.keyCode == 27 && !inmainMenu) {
    paused = true
  }
})

document.addEventListener('keyup', function(event) {
  if (event.keyCode == 37 || event.keyCode == 65) {
    leftArrow = false
  }
  if (event.keyCode == 39 || event.keyCode == 68) {
    rightArrow = false
  }
  if (event.keyCode == 38 || event.keyCode == 87) {
    upArrow = false
  }
  if (event.keyCode == 40 || event.keyCode == 83) {
    downArrow = false
  }
  if (event.keyCode == 32) {
    space = false
  }
})

function drawCircle(x, y, r, c, lW) {
    draw.beginPath();
    draw.arc(x, y, r, 0, 2 * Math.PI, false);
    if (lW > 0){
        draw.lineWidth = lW;
        draw.stroke();
    }
    if (c != 0){
      draw.fillStyle = c
      draw.fill();
    }
}

function drawRectangle(x, y, w, h, c, lW) {
  draw.beginPath();
  draw.rect(x, y, w, h);
  if (lW > 0){
    draw.lineWidth = lW;
    draw.stroke();
  }
  if (c != 0){
      draw.fillStyle = c
      draw.fill();
    }
}

function drawLine(x, y, x2, y2, lW){
  draw.lineWidth = lW
  draw.beginPath();
  draw.moveTo(x, y);
  draw.lineTo(x2, y2);
  draw.stroke();
}

function drawTriangle(x1, y1, x2, y2, x3, y3, lW, c){
  draw.beginPath();
  draw.moveTo(x1, y1);
  draw.lineTo(x2, y2);
  draw.lineTo(x3, y3);
  draw.lineTo(x1, y1);
  if (lW > 0){
    draw.lineWidth = lW;
    draw.stroke();
  }
  if (c != 0){
      draw.fillStyle = c
      draw.fill();
    }
}

function specialSemi(x, y, r, n1, n2, lW, c) {
  draw.beginPath();
  draw.arc(x, y, r, n1 * Math.PI, n2 * Math.PI, false);
  draw.closePath();
  if (lW > 0){
    draw.lineWidth = lW;
    draw.stroke();
  }
  if (c != 0){
      draw.fillStyle = c
      draw.fill();
    }
}

function drawNumber(num, x, y, time){
  if (mode == "Hard" || mode == "Medium" && time > 50 && time <= 200 || mode == "Medium" && time > 240 ){
    draw.font = '25px Sans-serif';
    draw.strokeStyle = 'black';
    draw.lineWidth = 8;
    if (num < 10){
      draw.strokeText(num, x-5, y+10);
      draw.fillStyle = 'white';
      draw.fillText(num, x-5, y+10);
    }else{
      draw.strokeText(num, x-12.5, y+10);
      draw.fillStyle = 'white';
      draw.fillText(num, x-12.5, y+10);
    }
  } else if (mode == "Easy"|| mode == "Medium" && time <= 50 ||mode == "Medium" && time <= 240 && time >= 200){
    draw.font = '25px Sans-serif';
    draw.strokeStyle = 'black';
    draw.lineWidth = 8;
    if (num < 10){
      draw.strokeText(num, x-5, y+10);
    }else{
      draw.strokeText(num, x-12.5, y+10);
    }
    if (theNumber % num == 0 || num % theNumber == 0 ){
      draw.fillStyle = '#14de32';
    } else{
      draw.fillStyle = '#ff0000';
    }
    if (num < 10){
      draw.fillText(num, x-5, y+10);
    }else{
      draw.fillText(num, x-12.5, y+10);
    }
  }
}

function drawtextWithOutline(text, x, y){
  draw.font = '50px Sans-serif';
  draw.strokeStyle = 'black';
  draw.lineWidth = 8;
  draw.strokeText(text, x, y);
  draw.fillStyle = 'white';
  draw.fillText(text, x, y);
}


function player(x, y, c, state){
  if (state ==  "Idle"){
    drawRectangle(x+10, y+22, 7, 13, c, 10)
    drawRectangle(x-15, y+22, 7, 13, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x+10, y+18, 7, 13, c, 0)
    drawRectangle(x-15, y+18, 7, 13, c, 0)
    drawCircle(x-20, y-5, 5, "white", 10)
    drawCircle(x-20, y-5, 2, "black", 0)
    drawCircle(x+20, y-5, 5, "white", 10)
    drawCircle(x+20, y-5, 2, "black", 0)
    drawRectangle(x-10, y+10, 20, 5, "black", 0)
  }
  if (state ==  "down1"){
    drawRectangle(x+10, y+22, 7, 13, c, 10)
    drawRectangle(x-15, y+22, 7, 8, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x+10, y+18, 7, 13, c, 0)
    drawRectangle(x-15, y+18, 7, 11, c, 0)
    drawCircle(x-20, y-5, 5, "white", 10)
    drawCircle(x-20, y-5, 2, "black", 0)
    drawCircle(x+20, y-5, 5, "white", 10)
    drawCircle(x+20, y-5, 2, "black", 0)
    drawRectangle(x-10, y+10, 20, 5, "black", 0)
  }
  if (state ==  "down2"){
    drawRectangle(x+10, y+22, 7, 8, c, 10)
    drawRectangle(x-15, y+22, 7, 13, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x+10, y+18, 7, 11, c, 0)
    drawRectangle(x-15, y+18, 7, 13, c, 0)
    drawCircle(x-20, y-5, 5, "white", 10)
    drawCircle(x-20, y-5, 2, "black", 0)
    drawCircle(x+20, y-5, 5, "white", 10)
    drawCircle(x+20, y-5, 2, "black", 0)
    drawRectangle(x-10, y+10, 20, 5, "black", 0)
  }
  if (state ==  "up1"){
    drawRectangle(x+10, y+22, 7, 13, c, 10)
    drawRectangle(x-15, y+22, 7, 8, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x+10, y+18, 7, 13, c, 0)
    drawRectangle(x-15, y+18, 7, 11, c, 0)
  }
  if (state ==  "up2"){
    drawRectangle(x+10, y+22, 7, 8, c, 10)
    drawRectangle(x-15, y+22, 7, 13, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x+10, y+18, 7, 11, c, 0)
    drawRectangle(x-15, y+18, 7, 13, c, 0)
  }
  if (state ==  "right1"){
    drawRectangle(x-5, y+22, 7, 13, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x-5, y+18, 7, 13, c, 0)
    drawCircle(x+10, y-5, 5, "white", 10)
    drawCircle(x+10, y-5, 2, "black", 0)
    drawRectangle(x+10, y+10, 13, 5, "black", 0)
  }
  if (state ==  "right2"){
    drawRectangle(x-5, y+22, 7, 8, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x-5, y+18, 7, 11, c, 0)
    drawCircle(x+10, y-5, 5, "white", 10)
    drawCircle(x+10, y-5, 2, "black", 0)
    drawRectangle(x+10, y+10, 13, 5, "black", 0)
  }
  if (state ==  "left1"){
    drawRectangle(x-5, y+22, 7, 13, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x-5, y+18, 7, 13, c, 0)
    drawCircle(x-10, y-5, 5, "white", 10)
    drawCircle(x-10, y-5, 2, "black", 0)
    drawRectangle(x-23, y+10, 13, 5, "black", 0)
  }
  if (state ==  "left2"){
    drawRectangle(x-5, y+22, 7, 8, c, 10)
    drawCircle(x, y, 25, c, 10)
    drawRectangle(x-5, y+18, 7, 11, c, 0)
    drawCircle(x-10, y-5, 5, "white", 10)
    drawCircle(x-10, y-5, 2, "black", 0)
    drawRectangle(x-23, y+10, 13, 5, "black", 0)
  }
}

function background(x, y){
  drawRectangle(0, 0, 700, 600, "#2e3140", 0)
  drawCircle(350-x, 300-y, 560, "#6b6b6b", 0)
  drawCircle(350-x, 300-y, 400, "#525252", 0)
  drawCircle(350-x, 300-y, 200, "#363636", 0)
}

function dist(a, b){
  return Math.sqrt(a * a + b * b)
}

function bullet(x, y){
    drawCircle(x, y, 5, "#616161", 10)
}

function drawDoof(x, y){
  if (mode == "Hard"){
    drawCircle(x, y, 100, "red", 20)
  }else if (mode == "Easy"){
    drawCircle(x, y, 100, "#ff336d", 20)
  }else if (mode == "Medium"){
    drawCircle(x, y, 100, "#e36c0b", 20)
  }
  drawCircle(x-100, y-20, 30, "white", 20)
  drawCircle(x-110, y-30, 10, "black", 0)
  drawCircle(x+100, y-20, 30, "white", 20)
  drawCircle(x+110, y-20, 10, "black", 0)
  specialSemi(x, y, 50, 0.8, 1.8, 0, "black", 0)
  drawRectangle(x, y-29, 40, 30, "black", 0)
  drawRectangle(x-50, y, 90, 30, "black", 0)
}

function health(){
  if (inmainMenu == false){
    var p = 30
    for (let i = 0; i < hp; i++){
      drawCircle(p, 30, 20, "red", 10)
      p += 60
    }
    p+90
    for (let i = 0; i < 3-hp; i++){
      drawCircle(p+60*i, 30, 21, 0, 5)
    }
  }
}

function bulletNum(){
  return Math.floor(Math.random() * 98) + 2
}

function dodge(x, y, type){
  dash.play()
  isDodging = true
  canDodge = false
  space = false
  dodgeDirection = [0, 0]
  dodgeTime = 0
  if (type == "space"){
    if (leftArrow == true){
      dodgeDirection[0] -= 12
    }
    if (rightArrow == true){
      dodgeDirection[0] += 12
    }
    if (upArrow == true){
      dodgeDirection[1] -= 12
    }
    if (downArrow == true){
      dodgeDirection[1] += 12
    }
    if (dodgeDirection == [12,12] ||dodgeDirection == [-12,-12] || dodgeDirection == [-12,12] || dodgeDirection == [12,-12]){
      dodgeDirection[0] *= 0.50
      dodgeDirection[1] *= 0.50
    } 
  }else{
    dodgeDirection = [(x-350)/dist((x-350), (y-350))*13, (y-350)/dist((x-350), (y-350))*13]
  }
}

function game(){
    time += 1
    dooftime += 1
    frame += 1
    hitTime -= 1
    background(pos[0], pos[1])
    drawDoof(350-pos[0], 300-pos[1])

    if (Math.round(time/100) == time/100){
      seconds += 1
    }
    if (seconds == 60){
      minutes += 1
      seconds = 0
    }

    if (dodgeTime <= 10 && dodgeTime >= 1){
      let look = "Idle"
      if (upArrow == true){
        look = "up1"
      }else if (downArrow == true){
        look = "down1"
      }else if (rightArrow == true){
        look = "right1"
      }else if (leftArrow == true){
        look = "left1"
      }
      dashframe.push([350+pos[0], 300+pos[1], look, 10])
      
    }
    let die = null
    for( let j = 0; j < dashframe.length-1; j++){
      draw.globalAlpha = 0.2
      player(dashframe[j][0]-pos[0],dashframe[j][1]-pos[1], "#17afd1", dashframe[j][2])
      draw.globalAlpha = 1
      dashframe[j][3] -= 1
      if (dashframe[j][3] <= 0){
        die = j
      }
    }
    if (die != null){
      dashframe.splice(die,1)
    }

    if (time == 2000){
      phase = 0
    }
    if (time == 2500){
      doofset = 1
      doofcooldown = 100
      phase = 2
    }
    if (time == 10000){
      phase = 0
    }
    if (time == 10500){
      doofset = 1
      doofcooldown = 100
      phase = 3
    }
    if (time == 16500){
      phase = 0
    }
    if (time == 17000){
      doofset = 1
      doofcooldown = 50
      phase = 4
    }
    if (time == 25000){
      phase = 0
    }
    if (time == 25500){
      doofset = 1
      doofcooldown = 50
      phase = 5
    }
    if (time == 33500){
      won = true
    }

    if (!isDodging){
      if (upArrow){
        if (aniState == 1){
          player(350,300, "#17afd1", "up1")
        } if (aniState == 2){
          player(350,300, "#17afd1", "up2")
        }
      } else if (downArrow){
        if (aniState == 1){
          player(350,300, "#17afd1", "down1")
        } 
        if (aniState == 2){
          player(350,300, "#17afd1", "down2")
        }
      } else if (rightArrow){
        if (aniState == 1){
          player(350,300, "#17afd1", "right1")
        } 
        if (aniState == 2){
          player(350,300, "#17afd1", "right2")
        }
      } else if (leftArrow){
        if (aniState == 1){
          player(350,300, "#17afd1", "left1")
        } 
        if (aniState == 2){
          player(350,300, "#17afd1", "left2")
        }
      } else{
        player(350,300, "#17afd1", "Idle")
      }
    }else if (isDodging){
      if (upArrow){
        if (aniState == 1){
          player(350,300, "#92c8d4", "up1")
        } if (aniState == 2){
          player(350,300, "#92c8d4", "up2")
        }
      } else if (downArrow){
        if (aniState == 1){
          player(350,300, "#92c8d4", "down1")
        } 
        if (aniState == 2){
          player(350,300, "#92c8d4", "down2")
        }
      } else if (rightArrow){
        if (aniState == 1){
          player(350,300, "#92c8d4", "right1")
        } 
        if (aniState == 2){
          player(350,300, "#92c8d4", "right2")
        }
      } else if (leftArrow){
        if (aniState == 1){
          player(350,300, "#92c8d4", "left1")
        } 
        if (aniState == 2){
          player(350,300, "#92c8d4", "left2")
        }
      } else{
        player(350,300, "#92c8d4", "Idle")
      }
    }
    if (hitTime > 0){
      if (upArrow){
        if (aniState == 1){
          player(350,300, "#cf1717", "up1")
        } if (aniState == 2){
          player(350,300, "#cf1717", "up2")
        }
      } else if (downArrow){
        if (aniState == 1){
          player(350,300, "#cf1717", "down1")
        } 
        if (aniState == 2){
          player(350,300, "#cf1717", "down2")
        }
      } else if (rightArrow){
        if (aniState == 1){
          player(350,300, "#cf1717", "right1")
        } 
        if (aniState == 2){
          player(350,300, "#cf1717", "right2")
        }
      } else if (leftArrow){
        if (aniState == 1){
          player(350,300, "#cf1717", "left1")
        } 
        if (aniState == 2){
          player(350,300, "#cf1717", "left2")
        }
      } else{
        player(350,300, "#cf1717", "Idle")
      }
    } 
    
    drawNumber(theNumber, 350, 280, 200)
    if (!isDodging){
      if (leftArrow == true && dist(pos[0], pos[1]) < 530 && pos[0] < 0 || leftArrow == true && pos[0] >= 0){
          pos[0] -= 3
          
      }
      if (rightArrow == true && dist(pos[0], pos[1]) < 530 && pos[0] > 0 || rightArrow == true && pos[0] <= 0){
          pos[0] += 3
      }
      if (upArrow == true && dist(pos[0], pos[1]) < 530 && pos[1] < 0 || upArrow == true && pos[1] >= 0){
          pos[1] -= 3
      }
      if (downArrow == true && dist(pos[0], pos[1]) < 530 && pos[1] > 0 || downArrow == true && pos[1] <= 0){
          pos[1] += 3
      }
    }

    if (!inTutorial){
      if (phase == 1){
        if (dooftime >= doofcooldown && doofset == 1){
          dooftime = 0
          doofset = 2
          doofcooldown -= 0.25
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, 1, 0, bulletNum(), 0])
          bullets.push([350, 300, 0, 1, bulletNum(), 0])
          bullets.push([350, 300, -1, 0, bulletNum(), 0])
          bullets.push([350, 300, 0, -1, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, -0.75, bulletNum(), 0])
        }
        if (dooftime >= doofcooldown && doofset == 2){
          dooftime = 0
          doofset = 1
          doofcooldown -= 0.25
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, -0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, -0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, -0.75, bulletNum(), 0])
        }
      }
      if (phase == 2 || phase == 5){
        if (dooftime >= doofcooldown && doofset == 1){
          dooftime = 0
          doofset = 2
          doofcooldown -= 0.5
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, 1, 0, bulletNum(), 0])
          bullets.push([350, 300, 0, 1, bulletNum(), 0])
          bullets.push([350, 300, -1, 0, bulletNum(), 0])
          bullets.push([350, 300, 0, -1, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, -0.75, bulletNum(), 0])
        }
        if (dooftime >= doofcooldown && doofset == 2){
          dooftime = 0
          doofset = 3
          doofcooldown -= 0.5
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, -0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, -0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, -0.75, bulletNum(), 0])
        }
        if (dooftime >= doofcooldown && doofset == 3){
          dooftime = 0
          doofset = 1
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, (pos[0])/dist(pos[0], pos[1])*2, (pos[1])/dist(pos[0], pos[1])*2, bulletNum(), 0])
          bullets.push([350, 300, Math.cos(Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), Math.sin(Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
          bullets.push([350, 300, Math.cos(-Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(-Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), Math.sin(-Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(-Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
        }
      }
      if (phase == 3 || phase == 5){
        betweenTime += 1

        if (betweenTime >= 20){
          rotation += 0.05
          betweenTime = 0
          longPop2.currentTime = 0
          longPop2.play()
          bullets.push([350, 300, Math.cos(Math.PI*rotation)*2 - Math.sin(Math.PI*rotation)*2, Math.sin(Math.PI*rotation)*2 + Math.cos(Math.PI*rotation)*2, bulletNum(), 0])
          bullets.push([350, 300, Math.cos(-Math.PI*rotation)*2 - Math.sin(-Math.PI*rotation)*2, Math.sin(-Math.PI*rotation)*2 + Math.cos(-Math.PI*rotation)*2, bulletNum(), 0])
          if (time >= 13000){
            bullets.push([350, 300, -(Math.cos(Math.PI*rotation)*2 - Math.sin(Math.PI*rotation)*2), -(Math.sin(Math.PI*rotation)*2 + Math.cos(Math.PI*rotation)*2), bulletNum(), 0])
            bullets.push([350, 300, -(Math.cos(-Math.PI*rotation)*2 - Math.sin(-Math.PI*rotation)*2), -(Math.sin(-Math.PI*rotation)*2 + Math.cos(-Math.PI*rotation)*2), bulletNum(), 0])
          }
        }
        
        if (dooftime >= doofcooldown){
          dooftime = 0
          doofcooldown -= 0.5
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, (pos[0])/dist(pos[0], pos[1])*2, (pos[1])/dist(pos[0], pos[1])*2, bulletNum(), 0])
          bullets.push([350, 300, Math.cos(Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), Math.sin(Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
          bullets.push([350, 300, Math.cos(-Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(-Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), Math.sin(-Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(-Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
          bullets.push([350, 300, Math.cos(Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2), Math.sin(Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
          bullets.push([350, 300, Math.cos(-Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(-Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2), Math.sin(-Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(-Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
        }
      }
      if (phase == 4 || phase == 5){
        if (dooftime >= doofcooldown && doofset == 1){
          dooftime = 0
          doofset = 2
          doofcooldown -= 0.25
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, 1, 0, bulletNum(), 0])
          bullets.push([350, 300, 0, 1, bulletNum(), 0])
          bullets.push([350, 300, -1, 0, bulletNum(), 0])
          bullets.push([350, 300, 0, -1, bulletNum(), 0])
          //bullets.push([350, 300, 0.75, 0.75, bulletNum(), 0])
          //bullets.push([350, 300, 0.75, -0.75, bulletNum(), 0])
          //bullets.push([350, 300, -0.75, 0.75, bulletNum(), 0])
          //bullets.push([350, 300, -0.75, -0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, -0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, -0.75, bulletNum(), 0])
        }
        if (dooftime >= doofcooldown && doofset == 2){
          dooftime = 0
          doofset = 1
          doofcooldown -= 0.02
          longPop.currentTime = 0
          longPop.play()
          //bullets.push([350, 300, 1, 0, bulletNum(), 0])
          //bullets.push([350, 300, 0, 1, bulletNum(), 0])
          //bullets.push([350, 300, -1, 0, bulletNum(), 0])
          //bullets.push([350, 300, 0, -1, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, -0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, -0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, -0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, 0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, 0.35, 0.75, bulletNum(), 0])
          bullets.push([350, 300, -0.75, 0.35, bulletNum(), 0])
          bullets.push([350, 300, -0.35, -0.75, bulletNum(), 0])
        }
        if (dooftime >= doofcooldown && doofset == 3){
          doofset = 1
          dooftime = 0
          doofcooldown -= 0.02
          longPop.currentTime = 0
          longPop.play()
          bullets.push([350, 300, -((pos[0])/dist(pos[0], pos[1])*2), -((pos[1])/dist(pos[0], pos[1])*2), bulletNum(), 0])
          bullets.push([350, 300, -(Math.cos(Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2)), -(Math.sin(Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2)), bulletNum(), 0])
          bullets.push([350, 300, -(Math.cos(-Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(-Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2)), -(Math.sin(-Math.PI/8)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(-Math.PI/8)*((pos[1])/dist(pos[0], pos[1])*2)), bulletNum(), 0])
          bullets.push([350, 300, -(Math.cos(Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2)), -(Math.sin(Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2)), bulletNum(), 0])
          bullets.push([350, 300, -(Math.cos(-Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) - Math.sin(-Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2)), -(Math.sin(-Math.PI/4)*((pos[0])/dist(pos[0], pos[1])*2) + Math.cos(-Math.PI/4)*((pos[1])/dist(pos[0], pos[1])*2)), bulletNum(), 0])
        }
      }
    }

    for( let i = 0; i < bullets.length; i++){
      //bullet(bullets[i][0]-pos[0], bullets[i][1]-pos[1])c
      drawNumber(bullets[i][4], bullets[i][0]-pos[0], bullets[i][1]-pos[1], bullets[i][5])
      if (!stopped){
        bullets[i][5] += 1
        bullets[i][0] += bullets[i][2]
        bullets[i][1] += bullets[i][3]
        if (140 == bullets[i][5] && phase == 4 || 140 == bullets[i][5] && phase == 5){
          bullets[i][2] = (pos[0])/dist(pos[0], pos[1])*4
          bullets[i][3] = (pos[1])/dist(pos[0], pos[1])*4
        }
      }
      if (dist(bullets[i][0]-350-pos[0], bullets[i][1]-300-pos[1]) < 40 && isDodging == false && hitTime < 1){
        if(theNumber % bullets[i][4] == 0 || bullets[i][4] % theNumber == 0 ) {
          a = Math.floor(streak/10)
          a += 1
          score += a
          streak += 1
          streakView = 100
          heal.play()
          if (hp < 3){
            hp += 1
          }
        }else{
          hp -= 1
          hurt.play()
          hitTime = 100
          streak = 0
        }
        if (!inTutorial){
          theNumber = nextNumber
          nextNumber = Math.floor(Math.random() * 11) + 2
        } else{
          if (theNumber == 5){
            theNumber = 6
            nextNumber = 3
            pickedUp = true
          } else{
            theNumber = 3
            nextNumber = 8
          }
        }
        bullets.splice(i,1)
      }
      else if (dist(bullets[i][0]-350, bullets[i][1]-300) > 550){
        bullets.splice(i,1)
      }
    }
    if (hp <= 0){
      dead = true
      death.play()
    }
    if (canDodge == true && space == true){
      dodge(1, 1, "space")
    }
    if (isDodging == true){
      if (dodgeDirection[0] < 0 && dist(pos[0], pos[1]) < 530 && pos[0] < 0 || dodgeDirection[0] < 0 && pos[0] > 0){
        pos[0] += dodgeDirection[0]
      }
      if (dodgeDirection[0] > 0 && dist(pos[0], pos[1]) < 530 && pos[0] > 0 || dodgeDirection[0] > 0 && pos[0] < 0){
          pos[0] += dodgeDirection[0]
      }
      if (dodgeDirection[1] < 0 && dist(pos[0], pos[1]) < 530 && pos[1] < 0 || dodgeDirection[1] < 0 && pos[1] > 0){
          pos[1] += dodgeDirection[1]
      }
      if (dodgeDirection[1] > 0 && dist(pos[0], pos[1]) < 530 && pos[1] > 0 || dodgeDirection[1] > 0 && pos[1] < 0){
          pos[1] += dodgeDirection[1]
      }
    }
    dodgeTime += 1
    if (dodgeTime > 15){
      isDodging = false
    }
    if (dodgeTime > 80){
      dashframe = []
      canDodge = true
    }
    if (leftArrow || rightArrow || upArrow || downArrow){
      aniTime += 1
    }
    if (aniTime >= 10){
      if (aniState == 1){
        aniState = 2
      } else if (aniState == 2){
        aniState = 1
      }
      aniTime = 0
    }
    health()
    if (!inmainMenu){
      drawtextWithOutline("Score: "+ score, 400, 50)
      drawtextWithOutline("x"+ Math.floor((streak/10)+1), 480, 100)
      if (streakView > 0){
        draw.font = '50px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText(streak, 330, 50);
        draw.fillStyle = '#17afd1';
        draw.fillText(streak, 330, 50);
        streakView -= 1
      }
      drawRectangle(10, 70, 100, 100, "#17afd1", 10)
      draw.font = '25px Sans-serif';
      draw.strokeStyle = 'black';
      draw.lineWidth = 8;
      draw.strokeText("Next: ", 30, 100);
      draw.fillStyle = 'white';
      draw.fillText("Next: ", 30, 100);
      if (nextNumber >= 10){
        draw.font = '50px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText(nextNumber, 30, 150);
        draw.fillStyle = 'white';
        draw.fillText(nextNumber, 30, 150);
      }else{
        draw.font = '50px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText(nextNumber, 45, 150);
        draw.fillStyle = 'white';
        draw.fillText(nextNumber, 45, 150);
      }
      if (seconds >= 10){
        drawtextWithOutline(minutes+":"+seconds, 200, 50)
      }else{
        drawtextWithOutline(minutes+":0"+seconds, 200, 50)
      }
    }
    if (inTutorial){
      if (frame <= 500){
        drawtextWithOutline("Use WASD keys to move", 50, 200)
      }
      if (frame <= 1100 && frame >= 600){
        drawtextWithOutline("Use the Space Bar while ", 50, 150)
        drawtextWithOutline("holding a direction or by", 50, 200)
        drawtextWithOutline("clicking you can dash", 50, 250)
        drawtextWithOutline("Dashing allows you to dodge", 20, 400)
      }
      
      if (frame <= 2400 && frame >= 2400){
        bullets.push([350, 300, 0.75, 0.75, 15, 0])
        bullets.push([350, 300, -0.75, 0.75, 24, 0])
      }

      if (frame <= 2600 && frame >= 2600){
        stopped = true
      }

      if (frame <= 1700 && frame >= 1200){
        drawtextWithOutline("Your number is shown above", 50, 150)
        drawtextWithOutline("your head and your", 50, 200)
        drawtextWithOutline("next number is shown", 50, 250)
        drawtextWithOutline("in the top right", 50, 300)
      }

      if (frame <= 2300 && frame >= 1800){
        drawtextWithOutline("When you are hit by a number,", 20, 350)
        drawtextWithOutline("if one of the numbers is a ", 50, 400)
        drawtextWithOutline("factor the other you heal,", 50, 450)
        drawtextWithOutline("otherwise you take damage", 50, 500)
      }
      
      if (frame <= 2900 && frame >= 2400){
        drawtextWithOutline("Because your number is 5 ", 50, 150)
        drawtextWithOutline("getting hit by the 15", 50, 200)
        drawtextWithOutline("will allow you to heal", 50, 350)
        drawtextWithOutline("But getting hit by the", 50, 400)
        drawtextWithOutline("24 will hurt you", 50, 450)
      } 

      if (pickedUp){
        frames2 += 1
      }

      if (frame >= 2900 && frames2 >= 1){
        drawtextWithOutline("Now you can pick up the 24", 50, 200)
      }

      if (frames2 >= 400 && frame >= 3000){
        frames2 = 0
        inmainMenu = true
        clearInterval(gameLoop)
        mainMenu()
      }
    }
    if (dead){
      clearInterval(gameLoop)
      drawRectangle(200, 100, 300, 400, "grey", 10)
      draw.font = '50px Sans-serif';
      draw.strokeStyle = 'black';
      draw.lineWidth = 8;
      draw.strokeText("YOU DIED!", 220, 150);
      draw.fillStyle = 'red';
      draw.fillText("YOU DIED!", 220, 150);
      draw.font = '25px Sans-serif';
      draw.strokeStyle = 'black';
      draw.lineWidth = 8;
      if (inTutorial){
        draw.strokeText("Try again!", 220, 260);
      draw.fillStyle = 'white';
      draw.fillText("Try again!", 220, 260);
      }else{
        draw.strokeText("Score: "+score, 220, 260);
        draw.fillStyle = 'white';
        draw.fillText("Score: "+score, 220, 260);
      }
      drawRectangle(230, 300, 240, 100, "#17afd1", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Continue",250,370);
      if (mode == "Hard"){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("HighScore: "+highScore, 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("HighScore: "+highScore, 220, 220);
        if (score > highScore){
          localStorage.setItem("score", score)
        }
      }else if (inTutorial){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("5 is not factor of 24", 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("5 is not factor of 24", 220, 220);
      }else if (mode == "Easy"){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("HighScore: "+easyHighScore, 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("HighScore: "+easyHighScore, 220, 220);
        if (score > easyHighScore){
          localStorage.setItem("easyScore", score)
        }
      }else if (mode == "Medium"){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("HighScore: "+ mediumHighScore, 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("HighScore: "+mediumHighScore, 220, 220);
        if (score > mediumHighScore){
          localStorage.setItem("mediumScore", score)
        }
      }
    }
    if (won){
      clearInterval(gameLoop)
      drawRectangle(200, 100, 300, 400, "grey", 10)
      draw.font = '50px Sans-serif';
      draw.strokeStyle = 'black';
      draw.lineWidth = 8;
      draw.strokeText("YOU WON!", 220, 150);
      draw.fillStyle = 'green';
      draw.fillText("YOU WON!", 220, 150);
      draw.font = '25px Sans-serif';
      draw.strokeStyle = 'black';
      draw.lineWidth = 8;
      draw.strokeText("Score: "+score, 220, 260);
      draw.fillStyle = 'white';
      draw.fillText("Score: "+score, 220, 260);
      drawRectangle(230, 300, 240, 100, "#17afd1", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Continue",250,370);
      if (mode == "Hard"){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("HighScore: "+highScore, 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("HighScore: "+highScore, 220, 220);
        if (score > highScore){
          localStorage.setItem("score", score)
        }
      }else if (mode == "Easy"){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("HighScore: "+easyHighScore, 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("HighScore: "+easyHighScore, 220, 220);
        if (score > easyHighScore){
          localStorage.setItem("easyScore", score)
        }
      }else if (mode == "Medium"){
        draw.font = '25px Sans-serif';
        draw.strokeStyle = 'black';
        draw.lineWidth = 8;
        draw.strokeText("HighScore: "+ mediumHighScore, 220, 220);
        draw.fillStyle = 'white';
        draw.fillText("HighScore: "+mediumHighScore, 220, 220);
        if (score > mediumHighScore){
          localStorage.setItem("mediumScore", score)
        }
      }
    }
    if (paused){
      info = false
      clearInterval(gameLoop)
      draw.globalAlpha = 0.5
      drawRectangle(0, 0, 700, 600, "black", 10)
      draw.globalAlpha = 1
      drawRectangle(100, 70, 500, 430, "grey", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Paused",280,120);
      drawRectangle(200, 380, 300, 100, "#17afd1", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Continue",260,450);
      drawRectangle(200, 260, 300, 100, "#17afd1", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Settings",260,330);
      drawRectangle(200, 140, 300, 100, "#17afd1", 10)
      draw.fillStyle = "black"
      draw.font = "50px Arial";
      draw.fillText("Exit",310,210);
    }

}

function startTimer() {
  clearInterval(gameLoop)
  gameLoop = window.setInterval(game, 10)
}

function mainMenu(){
  audio.pause()
  mainMenuMusic.play()
  info = false
  settings = false
  hitTime = 0
  phase = 1
  score = 0
  streak = 0
  leftArrow = false
  rightArrow = false
  upArrow = false
  downArrow = false
  pos = [100, 100]
  bullets = []
  dooftime = 0
  doofcooldown = 200
  doofset = 1
  hp = 3
  dodgeDirection = [0, 0]
  dodgeTime = 10
  isDodging = false
  canDodge = true
  space = false
  rotation = 0.01
  betweenTime = 0
  time =  0
  inTutorial = false
  stopped = false
  nextNumber = Math.floor(Math.random() * 11) + 2
  dead = false
  won = false
  paused = false
  dashframe = []
  seconds = 0
  minutes = 0

  drawRectangle(0, 0, 700, 600, "grey", 0)
  drawRectangle(200, 100, 300, 100, "#17afd1", 10)
  draw.fillStyle = "black"
  draw.font = "50px Arial";
  draw.fillText("Start",290,170);
  drawRectangle(200, 250, 300, 100, "#17afd1", 10)
  draw.fillStyle = "black"
  draw.font = "50px Arial";
  if (mode == "Hard"){
    draw.fillText("Hard Mode",230,320);
  } else if (mode == "Easy"){
    draw.fillText("Easy Mode",230,320);
  } else if (mode == "Medium"){
    draw.font = "45px Arial";
    draw.fillText("Medium Mode",210,320);
  }
  drawRectangle(200, 400, 300, 100, "#17afd1", 10)
  draw.fillStyle = "black"
  draw.font = "50px Arial";
  draw.fillText("Tutorial",260,470);
  highScore = localStorage.getItem("score")
  easyHighScore = localStorage.getItem("easyScore")
  mediumHighScore = localStorage.getItem("mediumScore")
  if (easyHighScore == null){
    easyHighScore = 0
  }
  if (mediumHighScore == null){
    mediumHighScore = 0
  }
  if (highScore == null){
    highScore = 0
  }
  draw.fillStyle = "black"
  draw.font = "25px Arial";
  if (mode == "Hard"){
    draw.fillText("Hard Mode HighScore: " + highScore,20, 560);
  }else if (mode == "Easy"){
    draw.fillText("Easy Mode HighScore: " + easyHighScore,20, 560);
  }else if (mode == "Medium"){
    draw.fillText("Medium Mode HighScore: " + mediumHighScore,20, 560);
  }
  drawtextWithOutline("Factors Game", 190, 60)
  drawRectangle(630, 530, 50, 50, "#17afd1", 10)
  draw.fillStyle = "black"
  draw.font = "50px Arial";
  draw.fillText("?",640,573);
  drawRectangle(630, 460, 50, 50, "#17afd1", 10)
  drawCircle(655, 485, 10, 0, 10)
  drawLine(640, 470, 650, 480, 7)
  drawLine(670, 500, 660, 490, 7)
  drawLine(640, 500, 650, 490, 7)
  drawLine(670, 470, 660, 480, 7)
  drawLine(655, 465, 655, 480, 7)
  drawLine(655, 505, 655, 490, 7)
  drawLine(635, 485, 650, 485, 7)
  drawLine(675, 485, 660, 485, 7)
}

mainMenu()
    </script>
</body>

</html>
